tinymce.addI18n('zh_CN', {
  'Form plugin': '表单模式'
});

(function () {
  'use strict';

  var global = tinymce.util.Tools.resolve('tinymce.PluginManager');

  var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');

  var register = function (editor) {
    editor.addCommand('mceForm', function () {
      // var dom = editor.dom;
      var blocks = editor.selection.getSelectedBlocks();
      var lhv = 0;
      global$1.each(blocks, function (block) {
        if (lhv == 0) {
          let el = block;
          while (el) {
            if (el.tagName === 'TABLE') {
              break;
            } else {
              el = el.parentElement;
            }
          }
          if (el) {
            if (el.classList.contains('mce-form-table')) {
              el.classList.remove('mce-form-table');
            } else {
              el.classList.add('mce-form-table');
            }
          }
        }
      });
    });
  };
  var Commands = { register: register };

  var register$1 = function (editor) {
    editor.ui.registry.addToggleButton('form', {
      text: '<svg t="1569421373231" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5503" width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"></style></defs><path d="M924.166 195.311L426.578 96.276c-7.685 20.978-15.236 41.501-22.724 62.05-50.006 137.238-100.048 274.463-149.935 411.745-6.018 16.563-15.68 28.891-34.028 31.533-25.709 3.701-52.692-20.765-39.726-55.847 16.35-44.236 32.436-88.568 48.594-132.875 44.66-122.457 89.296-244.92 133.946-367.38 9.663-26.5 25.998-35.602 53.404-30.15 186.352 37.069 372.71 74.1 559.076 111.098 30.27 6.009 43.56 27.3 34.155 56.349-66.566 205.655-134.104 410.981-213.825 612.033-17.654 44.522-38.004 87.797-65.606 127.301-40.426 57.86-95.148 88.293-166.212 92.4-41.444 2.396-79.287-6.848-116.077-23.448-104.513-47.161-208.66-95.135-313.365-141.863-30.102-13.434-57.97-29.052-79.305-54.67-34.033-40.87-45.181-88.691-41.74-140.569 1.166-17.579 4.3-35.028 6.732-54.093 4.613 1.627 7.854 2.629 10.989 3.895 140.309 56.675 280.582 113.44 420.983 169.884 7.263 2.919 9.627 6.163 9.527 14.132-0.429 33.998 2.782 67.483 18.776 98.43 19.36 37.463 56.585 54.873 98.531 48.889 46.034-6.566 74.698-35.07 97.563-72.078 28.236-45.701 47.48-95.575 66.579-145.447 59.862-156.327 113.236-314.93 165.461-473.931 5.204-15.844 10.37-31.699 15.815-48.353z" p-id="5504" fill="#222f3e"></path><path d="M663.91 673.716c0.435 26.227-24.338 44.526-51.355 36.048-55.889-17.54-111.474-36.063-166.99-54.757-17.938-6.04-28.405-23.11-26.802-40.313 1.642-17.635 14.795-31.548 33.874-34.113 6.511-0.875 13.783 0.283 20.123 2.325 53.89 17.358 107.679 35.034 161.422 52.847 19.64 6.509 29.422 19.429 29.728 37.963z m63.292-157.245c0.912 21.039-16.83 39.32-38.037 38.715a59.297 59.297 0 0 1-16.377-2.832 29800.289 29800.289 0 0 1-160.344-52.532c-22.836-7.558-34.348-26.955-28.827-47.646 5.391-20.207 24.434-32.637 45.267-27.473 19.314 4.784 38.106 11.712 57.069 17.879 37.002 12.034 73.987 24.122 110.932 36.331 19.774 6.536 29.504 18.795 30.317 37.558z m68.904-167.725c0.515 22.087-20.079 41.861-41.646 37.667-24.019-4.672-47.592-11.707-71.27-18.045a10386.688 10386.688 0 0 1-102.237-27.925c-17.428-4.857-28.394-16.163-30.295-34.471-1.633-15.724 5.142-27.919 18.481-36.336 11.477-7.24 23.669-6.172 36.021-2.775 38.794 10.671 77.594 21.318 116.392 31.97 15.142 4.157 30.396 7.942 45.403 12.536 18.437 5.642 28.73 19.289 29.151 37.379z m-387.483 39.72c25.087 0.346 44.033 17.278 44.056 39.369 0.021 20.745-18.157 38.617-39.045 38.388-25.02-0.273-43.87-17.161-43.938-39.365-0.064-20.969 17.894-38.682 38.927-38.392z m64.488-83.268c-24.696-0.45-43.311-17.441-42.987-39.236 0.32-21.508 17.817-38.225 39.531-37.763 25.687 0.546 43.862 17.261 43.243 39.769-0.601 21.889-17.432 37.638-39.787 37.23zM348.259 537.7c24.604 0.437 42.69 17.231 42.404 39.381-0.274 21.231-17.365 38.132-38.159 37.737-26.353-0.5-44.868-16.881-44.567-39.428 0.291-21.647 17.877-38.086 40.322-37.69z" p-id="5505" fill="#222f3e"></path></svg>',
      tooltip: 'Form plugin',
      onAction: function () {
        return editor.execCommand('mceForm');
      },
      onSetup: function (buttonApi) {
        var editorEventCallback = function (eventApi) {
          let el = eventApi.element;
          while (el) {
            if (el.tagName === 'TABLE') {
              break;
            } else {
              el = el.parentElement;
            }
          }
          if (el && el.classList.contains('mce-form-table')) {
            buttonApi.setActive(true);
          } else {
            buttonApi.setActive(false);
          }
        };
        editor.on('NodeChange', editorEventCallback);
        return function (buttonApi) {
          editor.off('NodeChange', editorEventCallback);
        }
      }
    });
  };
  var Buttons = { register: register$1 };

  function Plugin() {
    global.add('form', function (editor) {
      Commands.register(editor);
      Buttons.register(editor);
      editor.addShortcut('Meta+E', '', 'mceForm');
    });
  }

  Plugin();

}());
